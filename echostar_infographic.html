<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EchoStar SPM Implementation: Stakeholder Engagement Strategy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f0f4f8;
        }
        .teal-bg { background-color: #00A9E0; }
        .orange-bg { background-color: #F37021; }
        .lightblue-bg { background-color: #81D4FA; }
        .green-bg { background-color: #4CAF50; }
        .yellow-bg { background-color: #FFC107; }
        .red-bg { background-color: #F44336; }

        .teal-text { color: #00A9E0; }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -0.625rem;
            transform: translateY(-50%);
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 9999px;
            background-color: white;
            border: 4px solid #00A9E0;
        }
        .timeline-item.yellow::before { border-color: #FFC107; }
        .timeline-item.green::before { border-color: #4CAF50; }

        .flow-arrow {
            font-size: 2.5rem;
            line-height: 1;
            color: #9ca3af;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
            position: relative;
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #00A9E0;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 8px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-5xl font-bold teal-text mb-2">EchoStar ServiceNow SPM Implementation</h1>
            <h2 class="text-xl md:text-2xl font-semibold text-gray-600">Stakeholder Engagement Strategy</h2>
            <p class="mt-4 max-w-4xl mx-auto text-gray-500">
                A visual narrative of our deliberate strategy to unify diverse business units under a single ServiceNow SPM instance. This infographic outlines the phased rollout, structured engagement, and proactive risk management driving this transformation.
            </p>
            <button id="summarizeInfographicBtn" class="mt-6 bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                Summarize Infographic ✨
                <span id="summaryLoadingSpinner" class="loading-spinner hidden"></span>
            </button>
        </header>

        <section id="organization" class="mb-12">
            <h3 class="text-2xl font-bold text-center mb-6">Organizational Landscape</h3>
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="flex justify-center items-center mb-4">
                     <p class="text-center font-bold text-lg text-gray-700">Single SPM Instance Goal - Phased Approach</p>
                </div>
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-7 gap-4 text-white text-center">
                    <div class="teal-bg p-3 rounded-lg shadow"><strong>DISH</strong><br><span class="text-sm opacity-80">Primary Focus</span></div>
                    <div class="teal-bg p-3 rounded-lg shadow"><strong>Sling</strong><br><span class="text-sm opacity-80">Video Streaming</span></div>
                    <div class="teal-bg p-3 rounded-lg shadow"><strong>Video Services</strong><br><span class="text-sm opacity-80">Marketing</span></div>
                    <div class="teal-bg p-3 rounded-lg shadow"><strong>Shared Services</strong><br><span class="text-sm opacity-80">CXO Functions</span></div>
                    <div class="teal-bg p-3 rounded-lg shadow"><strong>Corporate</strong><br><span class="text-sm opacity-80">Legal, HR, CFO</span></div>
                    <div class="orange-bg p-3 rounded-lg shadow"><strong>Wireless</strong><br><span class="text-sm opacity-80">Most Resistant</span></div>
                    <div class="lightblue-bg p-3 rounded-lg shadow"><strong>Hughes</strong><br><span class="text-sm opacity-80">Legacy EchoStar</span></div>
                </div>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
            <div class="lg:col-span-1 grid grid-cols-2 md:grid-cols-2 gap-4">
                <div class="bg-white rounded-lg shadow-md p-4 text-center">
                    <p class="text-5xl font-bold teal-text">4</p>
                    <p class="font-semibold text-gray-600">SPM Modules</p>
                </div>
                <div class="bg-white rounded-lg shadow-md p-4 text-center">
                    <p class="text-5xl font-bold teal-text">2</p>
                    <p class="font-semibold text-gray-600">Key Workshop Groups</p>
                </div>
                 <div class="col-span-2 bg-white rounded-lg shadow-md p-4 text-center">
                    <p class="text-5xl font-bold teal-text">July 21</p>
                    <p class="font-semibold text-gray-600">Requirements Gathering Complete</p>
                </div>
            </div>

            <div class="lg:col-span-2 bg-white rounded-lg shadow-md p-6">
                <h3 class="text-2xl font-bold text-center mb-4">Stakeholder Groups</h3>
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center md:text-left">
                        <h4 class="font-bold text-lg mb-2">👤 Core Project Team</h4>
                        <ul class="text-sm text-gray-600 list-inside">
                            <li><strong>Sarah</strong> (IT PMO Lead)</li>
                            <li><strong>Laura</strong> (IT PMO)</li>
                            <li>IT Managers</li>
                            <li>Business Managers</li>
                        </ul>
                    </div>
                    <div class="text-center md:text-left">
                        <h4 class="font-bold text-lg mb-2">👤 IT Stakeholders</h4>
                        <ul class="text-sm text-gray-600 list-inside">
                            <li>IT Product Owners</li>
                            <li><strong>Pierre's Team</strong> (SN SMEs)</li>
                            <li>IT Delivery Teams</li>
                        </ul>
                    </div>
                    <div class="text-center md:text-left">
                        <h4 class="font-bold text-lg mb-2">👤 Business Stakeholders</h4>
                        <ul class="text-sm text-gray-600 list-inside">
                            <li>Business PMO (90% ID'd)</li>
                            <li>Line of Business Leaders</li>
                            <li>Portfolio Owners</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <section id="stakeholder-tips" class="mb-12 bg-white rounded-lg shadow-md p-6">
            <h3 class="text-2xl font-bold text-center mb-6">Stakeholder Engagement Tips ✨</h3>
            <p class="text-center text-gray-500 text-sm mb-4 max-w-2xl mx-auto">Get AI-driven tips for engaging specific stakeholder groups based on their characteristics.</p>
            <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 mb-6">
                <select id="stakeholderSelect" class="form-select border border-gray-300 rounded-md p-2 shadow-sm focus:ring-teal-500 focus:border-teal-500 block w-full md:w-auto">
                    <option value="">Select Stakeholder Group</option>
                    <option value="Core Project Team: Sarah (IT PMO Lead), Laura (IT PMO), IT Managers, Business Managers">Core Project Team</option>
                    <option value="IT Product Owners, Pierre's Team (ServiceNow SMEs), IT Delivery Teams">IT Stakeholders</option>
                    <option value="Business PMO (90% identified), Line of Business Leaders, Portfolio Owners">Business Stakeholders</option>
                    <option value="Wireless division: Retail & M&L divisions, known for 'Startup mentality, fast-moving, most resistant'">Wireless Division</option>
                    <option value="Hughes/Legacy EchoStar: Rockets, military, Delta Wi-Fi">Hughes/Legacy EchoStar</option>
                    <option value="DISH (Teal), Sling (Teal), Video Services (Teal), Shared Services (Teal), Corporate (Teal)">Primary Focus Divisions</option>
                </select>
                <button id="getTipsBtn" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                    Get Tips
                    <span id="tipsLoadingSpinner" class="loading-spinner hidden"></span>
                </button>
            </div>
            <textarea id="tipsOutput" rows="6" class="w-full border border-gray-300 rounded-md p-3 focus:ring-teal-500 focus:border-teal-500 resize-y" placeholder="Engagement tips will appear here..." readonly></textarea>
        </section>


        <section id="timeline" class="mb-12">
            <h3 class="text-2xl font-bold text-center mb-8">Engagement Timeline</h3>
            <div class="relative pl-8 border-l-4 border-gray-200">
                
                <div class="timeline-item yellow mb-10 pl-8">
                    <h4 class="font-bold text-lg">Pre-Implementation Phase</h4>
                    <p class="text-sm text-gray-500 mb-2">(Current - June 18)</p>
                    <ul class="text-sm list-disc list-outside ml-5 text-gray-600 space-y-1">
                        <li>Standing biweekly cadences established with stakeholders.</li>
                        <li>Stakeholder identification is 90% complete.</li>
                        <li>Acknowledged momentum concerns due to SOW delays.</li>
                    </ul>
                </div>

                <div class="timeline-item green mb-10 pl-8">
                    <h4 class="font-bold text-lg">Week 1: Kickoff & Workshops</h4>
                    <p class="text-sm text-gray-500 mb-2">(June 23 - 27)</p>
                    <ul class="text-sm list-disc list-outside ml-5 text-gray-600 space-y-1">
                        <li><strong>Mon 6/23 🗓️:</strong> Preview Session 1 (Demand & Project) for Core Team.</li>
                        <li><strong>Wed 6/25 🗓️:</strong> Demand Module Workshop for IT Product Owners.</li>
                        <li><strong>Thu 6/26 🗓️:</strong> Demand Module Workshop for Business PMO.</li>
                    </ul>
                </div>

                <div class="timeline-item green mb-10 pl-8">
                    <h4 class="font-bold text-lg">Week 2: Continued Engagement</h4>
                    <p class="text-sm text-gray-500 mb-2">(June 30 - July 4)</p>
                    <ul class="text-sm list-disc list-outside ml-5 text-gray-600 space-y-1">
                        <li><strong>Mon 6/30 🗓️:</strong> Preview Session 2 (Resource & Time Cards) for Core Team.</li>
                        <li>Project Module Workshops scheduled based on availability.</li>
                        <li>July 4 Holiday consideration for scheduling.</li>
                    </ul>
                </div>

                <div class="timeline-item green mb-10 pl-8">
                    <h4 class="font-bold text-lg">Weeks 3-4: Final Workshops & Requirements</h4>
                     <p class="text-sm text-gray-500 mb-2">(July 7 - 21)</p>
                    <ul class="text-sm list-disc list-outside ml-5 text-gray-600 space-y-1">
                        <li>Resource Management & Time Card (IT only) workshops held.</li>
                        <li><strong>Goal:</strong> Complete all module workshops by July 7.</li>
                        <li><strong>Goal:</strong> Begin requirements gathering (Workshots) and complete by July 21.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="strategy-details" class="mb-12">
             <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                <div class="lg:col-span-3 bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-2xl font-bold text-center mb-6">Workshop & Workshot Structure</h3>
                    <p class="text-center text-gray-500 text-sm mb-6">Our structured engagement process ensures alignment, demonstrates value, and captures detailed needs through an iterative cycle.</p>
                    <div class="flex flex-col md:flex-row items-center justify-around space-y-4 md:space-y-0 md:space-x-4">
                        <div class="text-center p-4 border-2 border-dashed border-gray-300 rounded-lg">
                            <h4 class="font-bold">1. Preview Sessions</h4>
                            <p class="text-xs text-gray-500">Core Team Only (1hr)</p>
                            <p class="text-sm mt-1">High-level overview & content filtering.</p>
                        </div>
                        <div class="flow-arrow transform md:rotate-0">↓</div>
                        <div class="text-center p-4 border-2 border-dashed border-teal-400 rounded-lg">
                            <h4 class="font-bold">2. Workshops</h4>
                            <p class="text-xs text-gray-500">Stakeholders (2hr)</p>
                            <p class="text-sm mt-1">"See what you're getting" with OOTB demos.</p>
                        </div>
                        <div class="flow-arrow transform md:rotate-0">↓</div>
                        <div class="text-center p-4 border-2 border-dashed border-orange-400 rounded-lg">
                            <h4 class="font-bold">3. Workshots</h4>
                            <p class="text-xs text-gray-500">Stakeholders</p>
                            <p class="text-sm mt-1">Capture gaps & configuration requirements.</p>
                        </div>
                    </div>
                </div>
                 <div class="lg:col-span-2 bg-white rounded-lg shadow-md p-6 flex flex-col items-center justify-center">
                    <h3 class="text-xl font-bold text-center mb-4">Business PMO Identification</h3>
                    <div class="chart-container h-48 md:h-64">
                        <canvas id="stakeholderChart"></canvas>
                    </div>
                    <p class="text-center text-gray-500 text-sm mt-4">A key success factor is having 90% of Business PMO contacts, our primary gatekeepers to IT, identified and engaged early.</p>
                </div>
            </div>
        </section>

        <section id="implementation-phases" class="mb-12 bg-white rounded-lg shadow-md p-6">
            <h3 class="text-2xl font-bold text-center mb-6">Phased Implementation Strategy</h3>
            <p class="text-center text-gray-500 text-sm mb-8 max-w-2xl mx-auto">We are building momentum with receptive divisions first, creating a showcase of success to encourage enterprise-wide adoption before approaching more resistant areas.</p>
            <div class="flex flex-col md:flex-row justify-between items-center text-center space-y-6 md:space-y-0 md:space-x-4">
                <div class="flex-1 p-4">
                    <div class="teal-bg text-white w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2 text-2xl font-bold">1</div>
                    <h4 class="font-bold text-lg">Foundation</h4>
                    <p class="text-sm text-gray-600">Focus on DISH/Corporate to establish a "sexy toy" showcase and build quick wins.</p>
                </div>
                <div class="flow-arrow hidden md:block">→</div>
                 <div class="flow-arrow block md:hidden">↓</div>
                <div class="flex-1 p-4">
                    <div class="lightblue-bg text-white w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2 text-2xl font-bold">2</div>
                    <h4 class="font-bold text-lg">Expansion</h4>
                    <p class="text-sm text-gray-600">Integrate Hughes/Legacy EchoStar, leveraging Phase 1 success stories.</p>
                </div>
                 <div class="flow-arrow hidden md:block">→</div>
                 <div class="flow-arrow block md:hidden">↓</div>
                <div class="flex-1 p-4">
                    <div class="orange-bg text-white w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-2 text-2xl font-bold">3</div>
                    <h4 class="font-bold text-lg">Full Integration</h4>
                    <p class="text-sm text-gray-600">Approach Wireless division after 3-12 months, requiring careful political navigation.</p>
                </div>
            </div>
        </section>

        <section id="communication-generator" class="mb-12 bg-white rounded-lg shadow-md p-6">
            <h3 class="text-2xl font-bold text-center mb-6">Generate Communication Draft ✨</h3>
            <p class="text-center text-gray-500 text-sm mb-4 max-w-2xl mx-auto">Leverage AI to draft communications for various implementation phases and purposes.</p>
            <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 mb-6">
                <select id="phaseSelect" class="form-select border border-gray-300 rounded-md p-2 shadow-sm focus:ring-teal-500 focus:border-teal-500 block w-full md:w-auto">
                    <option value="">Select Phase</option>
                    <option value="Phase 1: Foundation">Phase 1: Foundation</option>
                    <option value="Phase 2: Expansion">Phase 2: Expansion</option>
                    <option value="Phase 3: Full Integration">Phase 3: Full Integration</option>
                    <option value="Pre-Implementation">Pre-Implementation</option>
                </select>
                <input type="text" id="purposeInput" placeholder="e.g., Kick-off email, Weekly update, Risk announcement" class="form-input border border-gray-300 rounded-md p-2 shadow-sm focus:ring-teal-500 focus:border-teal-500 block w-full md:w-auto">
                <button id="generateCommunicationBtn" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                    Generate Draft
                    <span id="commLoadingSpinner" class="loading-spinner hidden"></span>
                </button>
            </div>
            <textarea id="communicationOutput" rows="8" class="w-full border border-gray-300 rounded-md p-3 focus:ring-teal-500 focus:border-teal-500 resize-y" placeholder="Your generated communication draft will appear here..." readonly></textarea>
            <button id="copyCommunicationBtn" class="mt-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 hidden">
                Copy to Clipboard
            </button>
        </section>

        <footer id="risks" class="red-bg text-white rounded-lg shadow-lg p-6">
            <h3 class="text-2xl font-bold text-center mb-4">Key Risk Indicators</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
                <div>
                    <p class="text-3xl">⚠️</p>
                    <p class="font-semibold" data-risk="Document Access">Document Access</p>
                    <p class="text-sm opacity-80">Firewall issues can hinder collaboration & environment prep.</p>
                </div>
                 <div>
                    <p class="text-3xl">⚠️</p>
                    <p class="font-semibold" data-risk="Wireless Resistance">Wireless Resistance</p>
                    <p class="text-sm opacity-80">"Startup mentality" requires delicate political navigation.</p>
                </div>
                 <div>
                    <p class="text-3xl">⚠️</p>
                    <p class="font-semibold" data-risk="Holiday Scheduling">Holiday Scheduling</p>
                    <p class="text-sm opacity-80">Upcoming holidays can impact the aggressive timeline.</p>
                </div>
                 <div>
                    <p class="text-3xl">⚠️</p>
                    <p class="font-semibold" data-risk="Momentum Loss">Momentum Loss</p>
                    <p class="text-sm opacity-80">Past delays create a need to maintain active engagement.</p>
                </div>
            </div>
            <div class="mt-6">
                <h3 class="text-2xl font-bold text-center mb-4">Risk Mitigation Suggester ✨</h3>
                <p class="text-center text-white text-sm mb-4 max-w-2xl mx-auto opacity-80">Select a project risk to get AI-generated mitigation strategies.</p>
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 mb-6">
                    <select id="riskSelect" class="form-select border border-gray-300 rounded-md p-2 shadow-sm focus:ring-teal-500 focus:border-teal-500 block w-full md:w-auto text-gray-800">
                        <option value="">Select a Risk</option>
                        <option value="Document Access/Firewall issues">Document Access/Firewall issues</option>
                        <option value="Wireless division resistance">Wireless division resistance</option>
                        <option value="Holiday scheduling conflicts">Holiday scheduling conflicts</option>
                        <option value="Momentum loss concerns due to SOW delays">Momentum loss concerns</option>
                    </select>
                    <button id="getMitigationBtn" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                        Suggest Mitigation
                        <span id="mitigationLoadingSpinner" class="loading-spinner hidden"></span>
                    </button>
                </div>
                <textarea id="mitigationOutput" rows="6" class="w-full border border-gray-300 rounded-md p-3 focus:ring-teal-500 focus:border-teal-500 resize-y text-gray-800" placeholder="Mitigation strategies will appear here..." readonly></textarea>
            </div>
        </footer>

    </div>

    <!-- Summary Modal -->
    <div id="summaryModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3 class="text-2xl font-bold teal-text mb-4">Infographic Summary</h3>
            <p id="summaryText" class="text-gray-700"></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const stakeholderCtx = document.getElementById('stakeholderChart').getContext('2d');
            new Chart(stakeholderCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Identified', 'To Be Identified'],
                    datasets: [{
                        label: 'Business PMO Contacts',
                        data: [90, 10],
                        backgroundColor: [
                            '#00A9E0',
                            '#e5e7eb'
                        ],
                        borderColor: [
                            '#FFFFFF',
                            '#FFFFFF'
                        ],
                        borderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                             callbacks: {
                                title: function(tooltipItems) {
                                    const item = tooltipItems[0];
                                    let label = item.chart.data.labels[item.dataIndex];
                                    if (Array.isArray(label)) {
                                      return label.join(' ');
                                    } else {
                                      return label;
                                    }
                                }
                            }
                        }
                    }
                }
            });

            const summarizeInfographicBtn = document.getElementById('summarizeInfographicBtn');
            const summaryModal = document.getElementById('summaryModal');
            const closeButton = document.querySelector('.close-button');
            const summaryText = document.getElementById('summaryText');
            const summaryLoadingSpinner = document.getElementById('summaryLoadingSpinner');

            const generateCommunicationBtn = document.getElementById('generateCommunicationBtn');
            const phaseSelect = document.getElementById('phaseSelect');
            const purposeInput = document.getElementById('purposeInput');
            const communicationOutput = document.getElementById('communicationOutput');
            const copyCommunicationBtn = document.getElementById('copyCommunicationBtn');
            const commLoadingSpinner = document.getElementById('commLoadingSpinner');

            const stakeholderSelect = document.getElementById('stakeholderSelect');
            const getTipsBtn = document.getElementById('getTipsBtn');
            const tipsOutput = document.getElementById('tipsOutput');
            const tipsLoadingSpinner = document.getElementById('tipsLoadingSpinner');

            const riskSelect = document.getElementById('riskSelect');
            const getMitigationBtn = document.getElementById('getMitigationBtn');
            const mitigationOutput = document.getElementById('mitigationOutput');
            const mitigationLoadingSpinner = document.getElementById('mitigationLoadingSpinner');

            summarizeInfographicBtn.addEventListener('click', async () => {
                summaryLoadingSpinner.classList.remove('hidden');
                summaryText.textContent = 'Generating summary...';

                const prompt = `Please provide a concise summary of the EchoStar ServiceNow SPM Implementation Stakeholder Engagement Strategy infographic. Focus on the main goals, organizational scope, key stakeholder groups, the timeline of engagement activities (pre-implementation to Week 4), the workshop/workshot structure, the phased implementation approach, and critical risks. The summary should be clear and professional, suitable for a high-level overview.`;
                
                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                    
                    const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        summaryText.textContent = result.candidates[0].content.parts[0].text;
                    } else {
                        summaryText.textContent = 'Failed to generate summary. Please try again.';
                        console.error('Gemini API response structure unexpected:', result);
                    }
                } catch (error) {
                    summaryText.textContent = 'Error generating summary: ' + error.message;
                    console.error('Error calling Gemini API for summary:', error);
                } finally {
                    summaryLoadingSpinner.classList.add('hidden');
                    summaryModal.style.display = 'flex';
                }
            });

            closeButton.addEventListener('click', () => {
                summaryModal.style.display = 'none';
            });

            window.addEventListener('click', (event) => {
                if (event.target == summaryModal) {
                    summaryModal.style.display = 'none';
                }
            });

            generateCommunicationBtn.addEventListener('click', async () => {
                const phase = phaseSelect.value;
                const purpose = purposeInput.value.trim();

                if (!phase || !purpose) {
                    communicationOutput.value = 'Please select a phase and provide a communication purpose.';
                    copyCommunicationBtn.classList.add('hidden');
                    return;
                }

                commLoadingSpinner.classList.remove('hidden');
                communicationOutput.value = 'Generating communication draft...';
                copyCommunicationBtn.classList.add('hidden');

                const prompt = `Draft a professional communication for the EchoStar ServiceNow SPM Implementation project.
                
                Phase: ${phase}
                Purpose: ${purpose}
                
                Keep it concise (around 150-200 words), professional, and include relevant details from the project context:
                - Goal: Unify diverse business units under a single ServiceNow SPM instance.
                - Key Stakeholders: IT Product Owners, Business PMO, Core Project Team (Sarah, Laura), Line of Business Leaders.
                - Modules: Demand, Project, Resource, Time Cards.
                - General approach: Phased (Foundation, Expansion, Full Integration), starting with receptive divisions (DISH, Corporate, Shared Services) before Hughes/Legacy EchoStar, and later Wireless (most resistant).
                - Engagement: Preview Sessions, Workshops (2hr, OOTB), Workshots (requirements gathering).
                
                Address it to "Team," and include a clear call to action or next steps if appropriate for the purpose.`;
                
                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                    
                    const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        communicationOutput.value = result.candidates[0].content.parts[0].text;
                        copyCommunicationBtn.classList.remove('hidden');
                    } else {
                        communicationOutput.value = 'Failed to generate draft. Please try again.';
                        console.error('Gemini API response structure unexpected:', result);
                    }
                } catch (error) {
                    communicationOutput.value = 'Error generating draft: ' + error.message;
                    console.error('Error calling Gemini API for communication:', error);
                } finally {
                    commLoadingSpinner.classList.add('hidden');
                }
            });

            copyCommunicationBtn.addEventListener('click', () => {
                communicationOutput.select();
                document.execCommand('copy');
                alert('Draft copied to clipboard!');
            });

            getTipsBtn.addEventListener('click', async () => {
                const stakeholderGroup = stakeholderSelect.value;
                if (!stakeholderGroup) {
                    tipsOutput.value = 'Please select a stakeholder group.';
                    return;
                }

                tipsLoadingSpinner.classList.remove('hidden');
                tipsOutput.value = 'Generating engagement tips...';

                const prompt = `Provide practical engagement tips for the following EchoStar ServiceNow SPM Implementation stakeholder group: "${stakeholderGroup}".
                
                Consider their typical roles, potential motivations, and any specific characteristics mentioned (e.g., resistance, startup mentality). Focus on actionable strategies for effective collaboration and information sharing. Keep it concise, in bullet points.`;
                
                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                    
                    const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        tipsOutput.value = result.candidates[0].content.parts[0].text;
                    } else {
                        tipsOutput.value = 'Failed to generate tips. Please try again.';
                        console.error('Gemini API response structure unexpected:', result);
                    }
                } catch (error) {
                    tipsOutput.value = 'Error generating tips: ' + error.message;
                    console.error('Error calling Gemini API for tips:', error);
                } finally {
                    tipsLoadingSpinner.classList.add('hidden');
                }
            });

            getMitigationBtn.addEventListener('click', async () => {
                const selectedRisk = riskSelect.value;
                if (!selectedRisk) {
                    mitigationOutput.value = 'Please select a risk.';
                    return;
                }

                mitigationLoadingSpinner.classList.remove('hidden');
                mitigationOutput.value = 'Generating mitigation strategies...';

                const prompt = `Suggest concrete mitigation strategies for the following risk in the EchoStar ServiceNow SPM Implementation project: "${selectedRisk}".
                
                Consider the context of a large enterprise IT implementation. Provide actionable steps and best practices. Keep it concise, in bullet points.`;
                
                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                    
                    const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        mitigationOutput.value = result.candidates[0].content.parts[0].text;
                    } else {
                        mitigationOutput.value = 'Failed to generate mitigation. Please try again.';
                        console.error('Gemini API response structure unexpected:', result);
                    }
                } catch (error) {
                    mitigationOutput.value = 'Error generating mitigation: ' + error.message;
                    console.error('Error calling Gemini API for mitigation:', error);
                } finally {
                    mitigationLoadingSpinner.classList.add('hidden');
                }
            });
        });
    </script>

</body>
</html>
