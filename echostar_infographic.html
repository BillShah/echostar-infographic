<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EchoStar SPM Implementation: Stakeholder Engagement Strategy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f0f4ff; /* Lighter background for better contrast */
        }
        /* Custom background colors for organizational units */
        .dish-bg { background-color: #00A9E0; } /* Teal (retained for consistency, though not directly used on new tiles) */
        .sling-bg { background-color: #4CAF50; } /* Green (retained for consistency) */
        .video-services-bg { background-color: #7B1FA2; } /* Deep Purple */
        .shared-services-bg { background-color: #FFC107; } /* Yellow */
        .corporate-bg { background-color: #F44336; } /* Red */
        .wireless-bg { background-color: #F37021; } /* Orange */
        .hughes-bg { background-color: #81D4FA; } /* Light Blue (retained for consistency) */

        /* Teal shades for metrics section (backgrounds for front face) - retained for SPM modules section */
        .spm-modules-front { background-color: #007B9E; } /* Darker teal for SPM Modules */
        .workshows-front { background-color: #0093BD; } /* Medium teal for Workshows */
        .workshops-front { background-color: #00A9E0; } /* Original teal for Workshops (lighter in context) */

        .teal-text { color: #00A9E0; } /* Define teal color for text */
        
        /* Tooltip styles */
        .tooltip-container {
            position: relative;
            display: inline-block;
        }
        .tooltip {
            visibility: hidden;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 10px;
            position: absolute;
            z-index: 100;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            min-width: 150px;
            max-width: 250px;
            font-size: 0.875rem;
            line-height: 1.2;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            pointer-events: none;
        }

        .tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
        }

        .tooltip-container:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        /* Specific tooltip background colors */
        .tooltip.tooltip-dark-blue { background-color: #2C3E50; }
        .tooltip.tooltip-dark-blue::after { border-color: #2C3E50 transparent transparent transparent; }
        .tooltip.tooltip-dark-green { background-color: #1A531A; }
        .tooltip.tooltip-green::after { border-color: #1A531A transparent transparent transparent; }
        .tooltip.tooltip-purple { background-color: #4A148C; }
        .tooltip.tooltip-purple::after { border-color: #4A148C transparent transparent transparent; }
        .tooltip.tooltip-dark-brown { background-color: #5A382A; }
        .tooltip.tooltip-dark-brown::after { border-color: #5A382A transparent transparent transparent; }
        .tooltip.tooltip-dark-gray { background-color: #34495E; }
        .tooltip.tooltip-gray::after { border-color: #34495E transparent transparent transparent; }

        /* Specific styles for the timeline cards */
        .timeline-card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 1rem;
            margin-bottom: 1rem;
            position: relative;
        }
        .timeline-card::before {
            content: none; /* Removes any default list styling */
        }
        .timeline-group-title {
            font-weight: bold;
            font-size: 1.25rem;
            color: #00A9E0; /* Teal */
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            text-align: left;
            padding-left: 2rem; /* Align with the vertical line */
            position: relative;
        }
        .timeline-group-title::before {
            content: '';
            position: absolute;
            top: 1.25rem;
            left: -1.75rem; /* Adjust to align with the vertical line */
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 9999px;
            background-color: #00A9E0; /* Teal dot */
            border: 2px solid white;
        }

        /* Collapsible specific styles */
        .collapsible-content {
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out;
            opacity: 1;
            max-height: 2000px; /* A large enough value to accommodate content when open */
            overflow: visible; /* Default to visible when open, allowing tooltips to escape */
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        .collapsible-content.collapsed {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            padding-top: 0;
            padding-bottom: 0;
        }
        .collapsible-toggle .collapsible-icon {
            transition: transform 0.3s ease-in-out;
        }
        .collapsible-toggle.collapsed .collapsible-icon {
            transform: rotate(-90deg); /* Rotate up when collapsed */
        }

        /* Adjustments for nested collapsible titles */
        .sub-collapsible-toggle {
            padding-left: 0; /* Remove default padding from timeline-group-title */
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            font-size: 1.125rem; /* Slightly smaller heading for sub-sections */
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        /* Specific display rule for hidden sub-collapsible toggles used with SPM module details */
        .sub-collapsible-toggle.hidden-sub-toggle {
            opacity: 0;
            visibility: hidden;
            height: 0; /* Collapse height too */
            margin-top: 0;
            margin-bottom: 0;
        }

        .sub-collapsible-toggle .collapsible-icon {
            font-size: 1.5rem; /* Smaller icon for sub-sections */
        }
        .sub-collapsible-content {
            padding-left: 0; /* Remove default padding for content, content within the card will handle its own padding */
        }

        /* Sticky header styles */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 20; /* Ensure it stays on top of other content */
            background-color: #f0f4ff; /* Match body background or slightly different */
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: top 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        .sticky-header.hidden-header {
            top: -100px; /* Move out of view */
            opacity: 0; /* Fade out */
            pointer-events: none; /* Disable interactions */
        }

        /* Header Text Carousel Styles */
        #header-text-carousel {
            height: 100px; /* Adjust based on the tallest content (H1 or P) */
            text-align: center;
        }
        .fade-element {
            position: absolute;
            width: 100%;
            transition: opacity 2s ease-in-out; /* Smoother transition (2 seconds) */
            opacity: 0;
            visibility: hidden;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* Center horizontally and vertically */
            margin: 0 !important;
            padding: 0 !important;
        }
        .fade-element.active-fade {
            opacity: 1;
            visibility: visible;
        }
        .fade-element.inactive-fade {
            opacity: 0;
            visibility: hidden;
        }

        /* Glow effect for DISH box */
        .dish-glow {
            animation: glow 1.5s infinite alternate;
        }

        /* H1 Glow effect (only when active) */
        .h1-glow.active-fade {
            animation: h1-glow 1.8s infinite alternate;
        }
        /* Ensure h1-glow is removed when inactive */
        .h1-glow.inactive-fade {
            animation: none;
            text-shadow: none;
        }

        /* H1 text size reduction (20%) */
        #mainTitle {
            font-size: 1.5rem; /* 20% reduction from original text-3xl (1.875rem) */
        }
        @media (min-width: 768px) { /* md breakpoint */
            #mainTitle {
                font-size: 2.4rem; /* 20% reduction from original text-5xl (3rem) */
            }
        }

        @keyframes glow {
            from {
                box-shadow: 0 0 5px rgba(0, 169, 224, 0.5), 0 0 10px rgba(0, 169, 224, 0.2);
            }
            to {
                box-shadow: 0 0 15px rgba(0, 169, 224, 0.8), 0 0 25px rgba(0, 169, 224, 0.4);
            }
        }

        @keyframes h1-glow {
            from {
                text-shadow: 0 0 5px rgba(0, 169, 224, 0.5), 0 0 10px rgba(0, 169, 224, 0.2);
            }
            to {
                text-shadow: 0 0 15px rgba(0, 169, 224, 0.8), 0 0 25px rgba(0, 169, 224, 0.4);
            }
        }

        /* Logo Fade effect */
        .logo-fade {
            animation: fade-in-out 3s infinite alternate;
        }

        @keyframes fade-in-out {
            0% { opacity: 0.3; }
            50% { opacity: 1; }
            100% { opacity: 0.3; }
        }

        /* Logo Shrink state */
        .logo-shrink {
            height: 4rem; /* Reduced height, e.g., h-16 (64px) */
            transition: height 0.5s ease-in-out, opacity 0.5s ease-in-out;
            opacity: 0.5; /* Slightly fade out when shrunk */
        }

        /* 3D Flip Card Styles - General for organizational boxes */
        .flip-card {
            background-color: transparent;
            perspective: 1000px; /* Needed for 3D effect */
            width: 200px; /* Increased width for larger tiles */
            height: 220px; /* Slightly longer tiles */
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Responsive adjustments for flip cards in general grid layouts */
        @media (min-width: 768px) { /* md breakpoint */
            .grid-cols-2 .flip-card,
            .grid-cols-3 .flip-card,
            .grid-cols-4 .flip-card { /* Adjusted for the new 4-column layout */
                width: 200px; /* Keep size consistent on medium/large screens */
                height: 220px; /* Keep longer height */
            }
        }

        /* Specific adjustments for metric flip cards in Key Metrics & Stakeholder Overview */
        /* Removed specific height/padding overrides for metrics flip cards as they are now stakeholder cards */
        #metrics-stakeholders-section .flip-card {
            width: 100%; /* Make them fill their grid column */
            height: 220px; /* Ensure consistent height for all stakeholder tiles */
            padding: 0; /* Reset padding to be controlled by inner elements */
            box-shadow: none; /* Remove outer shadow, it will be applied to inner faces */
            overflow: visible; /* Ensure content is not clipped by fixed dimensions */
        }

        /* Styles for the inner parts of the flip card (front and back) */
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s; /* Smooth flip animation */
            transform-style: preserve-3d; /* Keep children in 3D space */
            border-radius: inherit; /* Inherit rounded corners */
        }

        .flip-card:hover .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden; /* Hide the back of the card when flipped */
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0.75rem; /* Consistent padding for content inside */
            border-radius: inherit; /* Inherit rounded corners from flip-card */
            box-sizing: border-box; /* Include padding in the element's total width and height */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Apply shadow directly to front/back faces */
            color: white; /* All text on tiles should be white */
        }
        
        /* Default styling for the back face for organizational cards */
        .flip-card-back {
            transform: rotateY(180deg); /* Initially hidden */
            font-size: 1.125rem; /* Increased font size for readability (text-lg equivalent) */
            line-height: 1.5; /* Adjusted line height for readability */
            text-align: center;
        }

        /* Apply background colors to front and back for organizational flip cards */
        .video-services-bg .flip-card-front, .video-services-bg .flip-card-back { background-color: #7B1FA2; } /* Deep Purple */
        .shared-services-bg .flip-card-front, .shared-services-bg .flip-card-back { background-color: #FFC107; } /* Yellow */
        .corporate-bg .flip-card-front, .corporate-bg .flip-card-back { background-color: #F44336; } /* Red */
        .wireless-bg .flip-card-front, .wireless-bg .flip-card-back { background-color: #F37021; } /* Orange */

        /* Ensure text on all backgrounds is white (overriding previous black for light backgrounds) */
        .shared-services-bg .flip-card-front strong,
        .corporate-bg .flip-card-front strong,
        .wireless-bg .flip-card-front strong {
            color: white; /* Explicitly set to white */
        }
        .shared-services-bg .flip-card-back,
        .corporate-bg .flip-card-back,
        .wireless-bg .flip-card-back {
            color: white; /* Explicitly set to white */
        }

        /* IMPORTANT FIX: Ensure list items inside flip card backs are white and readable */
        .flip-card-back .custom-bullet-list li {
            color: white; /* Override the default gray from .custom-bullet-list li */
            font-size: 1rem; /* Adjust list item font size for readability */
        }
        /* Ensure the checkmark for list items on flip card backs is also white */
        .flip-card-back .custom-bullet-list li::before {
            color: white; /* Ensure checkmarks are white on flip card backs */
        }


        /* Increase font size for front of tiles */
        .flip-card-front strong {
            font-size: 1.5rem; /* Slightly larger main title */
        }
        .flip-card-front .text-sm { /* Adjusting text-sm for subtitle within strong context */
            font-size: 1rem; /* Slightly larger subtitle */
            opacity: 1; /* Ensure full opacity */
        }

        /* Styling for the "One way of Working!" text */
        .one-way-working-text {
            font-size: 1.5rem; /* Make it bigger */
            color: #7B1FA2; /* Deep Purple, same as Video Services tile */
            margin-bottom: 1rem; /* Add some space below */
        }


        /* --- NEW Stakeholder Overview Flip Card Styling --- */
        /* Core Project Team - Dark Teal */
        .core-project-team-bg .flip-card-front, .core-project-team-bg .flip-card-back { background-color: #007B9E; }
        /* IT Decision Makers - Medium Teal */
        .it-decision-makers-bg .flip-card-front, .it-decision-makers-bg .flip-card-back { background-color: #0093BD; }
        /* Steering Committee - Light Teal */
        .steering-committee-bg .flip-card-front, .steering-committee-bg .flip-card-back { background-color: #00A9E0; }
        /* Stakeholders - Indigo (New Color) */
        .stakeholders-bg .flip-card-front, .stakeholders-bg .flip-card-back { background-color: #3F51B5; }


        /* IMPORTANT: Ensure text on all new stakeholder tiles is white */
        .core-project-team-bg .flip-card-front strong,
        .it-decision-makers-bg .flip-card-front strong,
        .steering-committee-bg .flip-card-front strong,
        .stakeholders-bg .flip-card-front strong {
            color: white;
        }

        .core-project-team-bg .flip-card-back,
        .it-decision-makers-bg .flip-card-back,
        .steering-committee-bg .flip-card-back,
        .stakeholders-bg .flip-card-back {
            color: white;
        }

        /* Ensure checkmarks are white on new stakeholder flip card backs */
        .core-project-team-bg .flip-card-back .custom-bullet-list li::before,
        .it-decision-makers-bg .flip-card-back .custom-bullet-list li::before,
        .steering-committee-bg .flip-card-back .custom-bullet-list li::before,
        .stakeholders-bg .flip-card-back .custom-bullet-list li::before {
            color: white;
        }


        /* New styles for stakeholder group expandable cards - REMOVED AS THEY ARE NOW FLIP CARDS */
        /* .stakeholder-card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease-in-out;
            border: 1px solid transparent;
        }
        .stakeholder-card:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        Specific colors for stakeholder cards
        .stakeholder-card.core-project-bg { background-color: #E0F2F7; }
        .stakeholder-card.it-stakeholder-bg { background-color: #CCEEF5; }
        .stakeholder-card.business-stakeholder-bg { background-color: #B3E0EB; } */

        /* Collapsible content for the old stakeholder cards - REMOVED */
        /* .stakeholder-card-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
            font-weight: bold;
            color: #333;
            transition: color 0.3s ease-in-out;
        }
        .stakeholder-card-toggle:hover {
            color: #00A9E0;
        }
        .stakeholder-card-content {
            max-height: 500px;
            opacity: 1;
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out, padding 0.5s ease-in-out;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        .stakeholder-card-content.collapsed {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            padding-top: 0;
            padding-bottom: 0;
        }
        .stakeholder-card-toggle .collapsible-icon {
            transition: transform 0.3s ease-in-out;
            font-size: 1.25rem;
            color: #9ca3af;
            margin-left: 0.5rem;
        }
        .stakeholder-card-toggle:not(.collapsed) .collapsible-icon {
            transform: rotate(0deg);
        }
        .stakeholder-card-toggle.collapsed .collapsible-icon {
            transform: rotate(-90deg);
        } */


        /* Custom bullet list styles */
        .custom-bullet-list {
            list-style: none;
            padding-left: 0;
        }

        .custom-bullet-list li {
            position: relative;
            margin-bottom: 0.25rem;
            color: #555; /* Default color for custom bullets */
            text-align: left;
            padding-left: 1.2em;
        }

        .custom-bullet-list li::before {
            content: '\2713'; /* Checkmark unicode */
            color: #00A9E0;
            font-size: 0.9rem;
            position: absolute;
            left: 0;
            top: 0.15em;
            line-height: 1;
            padding-right: 0.3rem;
        }

        /* NEW specific styles for the 4-point roadmap timeline (retained for now, but section is removed) */
        .roadmap-timeline {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 40px auto;
            width: calc(100% - 20px);
            padding: 0 10px;
        }

        .roadmap-milestone {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 2;
            padding: 0 5px;
            flex-basis: 0;
        }

        .roadmap-milestone.active {
            color: #000;
            font-weight: 600;
        }

        .roadmap-milestone.future {
            color: #9aa3ad;
        }

        .roadmap-dot {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            box-sizing: border-box;
            margin-bottom: 8px; /* Space between dot and label */
        }

        .roadmap-milestone.active .roadmap-dot {
            background-color: #00A9E0;
            color: white;
            border: 2px solid #00A9E0;
        }

        .roadmap-milestone.future .roadmap-dot {
            background-color: transparent;
            border: 2px solid #9aa3ad;
            color: #9aa3ad;
        }

        /* Added a new class for the text content within milestones for consistent height */
        .roadmap-text-content {
            min-height: 60px; /* ALIGNMENT FIX: Ensures consistent height for all text blocks */
            display: flex;
            flex-direction: column;
            justify-content: center; /* Vertically center text within its fixed height */
            align-items: center;
        }

        /* Connecting line elements */
        .roadmap-line {
            height: 4px;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
        }

        .roadmap-line.active-line {
            background-color: #00A9E0;
            flex-grow: 3;
        }

        .roadmap-line.dashed-line {
            background-image: linear-gradient(to right, #9aa3ad 50%, transparent 50%);
            background-size: 16px 4px;
            background-repeat: repeat-x;
            flex-grow: 1;
        }

        /* Hidden elements for future phases */
        .hidden-element {
            display: none; /* Start hidden */
            opacity: 0; /* For transition effect */
            transition: opacity 0.5s ease-in-out;
        }
        .show-element {
            opacity: 1;
        }
        /* Specific display rules for elements being shown/hidden by JS */
        /* These override .hidden-element's display: none; when they are about to be shown */
        .roadmap-milestone.show-element { display: flex !important; }
        .roadmap-line.show-element { display: flex !important; }
        .phase-detail-card.show-element { display: flex !important; }


        /* Future states button */
        .future-states-button {
            background-color: #F37021;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease-in-out, transform 0.2s ease-in-out;
            border: none;
            display: block;
            margin: 20px auto;
            text-align: center;
        }
        .future-states-button:hover {
            background-color: #E26012;
            transform: translateY(-2px);
        }

        /* Styles for detailed phase description cards */
        .phase-detail-card {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1.25rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .phase-detail-card h5 {
            color: #00A9E0;
            font-weight: bold;
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }
        .phase-detail-card p {
            font-size: 0.875rem;
            color: #333;
            line-height: 1.4;
            margin-bottom: 0.75rem;
        }
        .phase-detail-card ul {
            list-style: none;
            padding-left: 0;
            margin-top: 0.5rem;
        }
        .phase-detail-card ul li {
            position: relative;
            padding-left: 1.2em;
            margin-bottom: 0.25rem;
            font-size: 0.875rem;
            color: #555;
        }
        .phase-detail-card ul li::before {
            content: '\2713';
            color: #00A9E0;
            font-size: 0.9em;
            position: absolute;
            left: 0;
            top: 0.15em;
        }

        /* NEW: Light background colors for module detail sections */
        .demand-bg-light { background-color: #E0F7FA; /* Light Blue */ }
        .project-bg-light { background-color: #D4EDDA; /* Light Green */ }
        .resource-bg-light { background-color: #FFFDE7; /* Light Yellow */ }
        .time-bg-light { background-color: #FFF3E0; /* Light Orange */ }
    </style>
</head>
<body>

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        
        <header id="mainHeader" class="text-center sticky-header">
            <div class="max-w-4xl mx-auto">
                <img id="echostarLogo" src="https://raw.githubusercontent.com/BillShah/echostar-infographic/main/EchoStar-Logo.wine%20FINAL.png" alt="EchoStar Logo - A stylized representation of the EchoStar brand" class="mx-auto h-24 m-0 logo-fade" onerror="this.onerror=null; this.src='https://placehold.co/150x50/cccccc/333333?text=EchoStar+Logo+Fallback';">
                <div id="header-text-carousel" class="relative overflow-hidden h-24 flex items-center justify-center">
                    <h1 id="mainTitle" class="font-bold teal-text fade-element active-fade">EchoStar ServiceNow SPM Implementation</h1>
                    <p id="strategyText" class="text-base md:text-lg teal-text fade-element inactive-fade">
                        Our deliberate strategy to unify diverse business units under a single EchoStar ServiceNow SPM instance. This infographic outlines the phased rollout and a structured engagement driving this transformation.
                    </p>
                </div>
                <p id="lastUpdated" class="text-xs text-gray-500 mt-2">This site was updated on...</p>
            </div>
        </header>

        <section id="organization-section" class="mb-6 bg-white rounded-lg shadow-md p-6">
            <div class="flex justify-between items-center cursor-pointer collapsible-toggle collapsed" data-target="organization-content" tabindex="0" role="button" aria-expanded="false" aria-controls="organization-content">
                <h3 class="text-2xl font-bold teal-text mb-0">Organizational Landscape</h3>
                <span class="text-3xl text-gray-500 transform transition-transform duration-300 collapsible-icon">▼</span>
            </div>
            <div id="organization-content" class="collapsible-content collapsed">
                <div class="flex justify-center items-center mt-6">
                    <p class="text-center font-bold one-way-working-text">One way of Working!</p>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-white text-center">
                    
                    <!-- Video Services Tile (combined DISH, Sling, Video Services) -->
                    <div class="flip-card video-services-bg">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <strong>Video Services</strong><br><span class="text-sm opacity-80">DISH & Sling</span>
                            </div>
                            <div class="flip-card-back">
                                <ul class="text-xs custom-bullet-list px-2" style="list-style-type: none; padding-left: 0; margin: 0; text-align: left;">
                                    <li>Sales</li>
                                    <li>Retention</li>
                                    <li>Marketing</li>
                                    <li>Programming</li>
                                    <li>DISH Business</li>
                                    <li>Product</li>
                                    <li>DISH Media</li>
                                    <li>Sling</li>
                                    <li>DISH Tech</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Shared Services Tile -->
                    <div class="flip-card shared-services-bg">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <strong>Shared Services</strong><br><span class="text-sm opacity-80">CXO Functions</span>
                            </div>
                            <div class="flip-card-back">
                                <ul class="text-xs custom-bullet-list px-2" style="list-style-type: none; padding-left: 0; margin: 0; text-align: left;">
                                    <li>CXO</li>
                                    <li>Billing & Credit (B&C)</li>
                                    <li>In Home Services (IHS)</li>
                                    <li>Manufacturing</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Corporate Tile -->
                    <div class="flip-card corporate-bg">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <strong>Corporate</strong><br><span class="text-sm opacity-80">Legal, HR, CFO</span>
                            </div>
                            <div class="flip-card-back">
                                Legal, HR, CFO functions, part of the initial receptive group.
                            </div>
                        </div>
                    </div>

                    <!-- Wireless Tile (combined Wireless & Hughes, now last) -->
                    <div class="flip-card wireless-bg">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <strong>Wireless</strong><br><span class="text-sm opacity-80">Retail & MNO</span>
                            </div>
                            <div class="flip-card-back">
                                Retail and MNO divisions. Focus on mobile operations and customer engagement.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- START: RENAMED AND RESTRUCTURED SECTION -->
        <section id="metrics-stakeholders-section" class="mb-6 bg-white rounded-lg shadow-md p-6">
            <div class="flex justify-between items-center cursor-pointer collapsible-toggle collapsed" data-target="metrics-stakeholders-content" tabindex="0" role="button" aria-expanded="false" aria-controls="metrics-stakeholders-content">
                <h3 class="text-2xl font-bold teal-text mb-0">Stakeholder Overview</h3>
                <span class="text-3xl text-gray-500 transform transition-transform duration-300 collapsible-icon">▼</span>
            </div>
            <div id="metrics-stakeholders-content" class="collapsible-content collapsed">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-white text-center mt-6">
                    
                    <!-- Core Project Team Tile -->
                    <div class="flip-card core-project-team-bg">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <strong>Core Project Team</strong>
                            </div>
                            <div class="flip-card-back">
                                <ul class="text-xs custom-bullet-list px-2" style="list-style-type: none; padding-left: 0; margin: 0; text-align: left;">
                                    <li><strong>Sarah</strong> (IT PMO Lead)</li>
                                    <li><strong>Laura</strong> (IT PMO)</li>
                                    <li>IT PMO Managers</li>
                                    <li><strong>Pierre's Team</strong> (SN SMEs)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- IT Decision Makers Tile (formerly IT Stakeholders) -->
                    <div class="flip-card it-decision-makers-bg">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <strong>IT Decision Makers</strong>
                            </div>
                            <div class="flip-card-back">
                                <ul class="text-xs custom-bullet-list px-2" style="list-style-type: none; padding-left: 0; margin: 0; text-align: left;">
                                    <li>IT Product Owners</li>
                                    <li>IT Delivery Teams</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Steering Committee Tile (formerly Business Stakeholders) -->
                    <div class="flip-card steering-committee-bg">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <strong>Steering Committee</strong>
                            </div>
                            <div class="flip-card-back">
                                <ul class="text-xs custom-bullet-list px-2" style="list-style-type: none; padding-left: 0; margin: 0; text-align: left;">
                                    <li>Key business leaders and PMO members who will utilize SPM for demand, project, and portfolio management.</li>
                                    <li>Line of Business Leaders</li>
                                    <li>Portfolio Owners</li>
                                    <li><em>Names on this tile will be updated soon</em></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- NEW Stakeholders Tile -->
                    <div class="flip-card stakeholders-bg">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <strong>Stakeholders</strong>
                            </div>
                            <div class="flip-card-back">
                                Names to be provided by customer.
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>
        <!-- END: RENAMED AND RESTRUCTURED SECTION -->
        
        <section id="timeline-section" class="mb-6 bg-white rounded-lg shadow-md p-6">
            <div class="flex justify-between items-center cursor-pointer collapsible-toggle collapsed" data-target="timeline-content" tabindex="0" role="button" aria-expanded="false" aria-controls="timeline-content">
                <h3 class="text-2xl font-bold teal-text mb-0">Engagement Timeline</h3>
                <span class="text-3xl text-gray-500 transform transition-transform duration-300 collapsible-icon">▼</span>
            </div>
            <div id="timeline-content" class="collapsible-content collapsed">
                <p class="text-center text-gray-500 text-sm mb-6 mt-6">All times are listed in Mountain Time (MT).</p>
                <div class="relative pl-8 border-l-4 border-gray-200">
                    
                    <div class="mb-4">
                        <div class="flex justify-between items-center cursor-pointer sub-collapsible-toggle collapsed" data-target="previews-content" tabindex="0" role="button" aria-expanded="false" aria-controls="previews-content">
                            <h4 class="timeline-group-title !mt-0 !mb-0 !p-0">Planning Previews (2 sessions)</h4>
                            <span class="text-2xl text-gray-500 transform transition-transform duration-300 collapsible-icon">▼</span>
                        </div>
                        <div id="previews-content" class="collapsible-content sub-collapsible-content collapsed">
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800">Preview A – Demand & Project</p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Monday, June 23, 2025</p>
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 08:00–08:45 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-dark-blue">Duration: 45 min</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core (Laura, Sarah, Managers and Intact leads)</p>
                            </div>
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>2. Preview B – Resource & Timecard</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Monday, June 30, 2025</p>
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 08:00–08:45 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-dark-green">Duration: 45 min</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core team</p>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="flex justify-between items-center cursor-pointer sub-collapsible-toggle collapsed" data-target="workshows-content" tabindex="0" role="button" aria-expanded="false" aria-controls="workshows-content">
                            <h4 class="timeline-group-title !mt-0 !mb-0 !p-0">Workshows (demos)</h4>
                            <span class="text-2xl text-gray-500 transform transition-transform duration-300 collapsible-icon">▼</span>
                        </div>
                        <div id="workshows-content" class="collapsible-content sub-collapsible-content collapsed">
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>1. Demand</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Wednesday, June 25, 2025</p>
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 11:00–13:00 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-purple">Duration: 90-120 mins</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core Team + IT + Business</p>
                            </div>
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>2. Project</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Tuesday, July 1, 2025</p>
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 11:00–13:00 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-dark-brown">Duration: 90-120 mins</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core Team + IT + Business</p>
                            </div>
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>3. Resource / Timecard</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Tuesday, July 8, 2025</p>
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 11:00–13:00 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-dark-gray">Duration: 90-120 mins</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core Team + IT + Business</p>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="flex justify-between items-center cursor-pointer sub-collapsible-toggle collapsed" data-target="workshops-content" tabindex="0" role="button" aria-expanded="false" aria-controls="workshops-content">
                            <h4 class="timeline-group-title !mt-0 !mb-0 !p-0">Workshops (requirements-gathering)</h4>
                            <span class="text-2xl text-gray-500 transform transition-transform duration-300 collapsible-icon">▼</span>
                        </div>
                        <div id="workshops-content" class="collapsible-content sub-collapsible-content collapsed">
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>1. Demand – IT</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Thursday, July 10, 2025</p>
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 11:00–12:30 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-dark-blue">Duration: 90 mins</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core + Decision‑makers (IT)</p>
                            </div>
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>2. Demand – Business</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Friday, July 11, 2025</p>
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 11:00–12:30 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-dark-green">Duration: 90 mins</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core + Decision‑makers (Business)</p>
                            </div>
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>3. Project – IT</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Monday, July 14, 2025</p> <!-- Added date for consistency -->
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 11:00–12:30 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-purple">Duration: 90 mins</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core + Decision‑makers (IT)</p>
                            </div>
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>4. Project – Business</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Tuesday, July 15, 2025</p> <!-- Added date for consistency -->
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 11:00–12:30 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-dark-brown">Duration: 90 mins</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core + Decision‑makers (Business)</p>
                            </div>
                            <div class="timeline-card">
                                <p class="text-md font-semibold text-gray-800"><strong>5. Resource/TC – IT</strong></p>
                                <p class="text-sm text-gray-600"><strong>Date:</strong> Monday, July 21, 2025</p>
                                <p class="text-sm text-gray-600"><strong>Time:</strong> 11:00–12:30 MT <span class="tooltip-container">ℹ️<span class="tooltip tooltip-dark-gray">Duration: 90 mins</span></span></p>
                                <p class="text-sm text-gray-600"><strong>Audience:</strong> Core + Decision‑makers (IT)</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <section id="workshops-structure-section" class="mb-6 bg-white rounded-lg shadow-md p-6">
            <div class="flex justify-between items-center cursor-pointer collapsible-toggle collapsed" data-target="workshops-structure-content" tabindex="0" role="button" aria-expanded="false" aria-controls="workshops-structure-content">
                <h3 class="text-2xl font-bold teal-text mb-0">Workshows & Workshops Structure</h3>
                <span class="text-3xl text-gray-500 transform transition-transform duration-300 collapsible-icon">▼</span>
            </div>
            <div id="workshops-structure-content" class="collapsible-content collapsed">
                <p class="text-center text-gray-500 text-sm mb-6 mt-6">Our structured engagement process ensures alignment, demonstrates value, and captures detailed needs through an iterative cycle.</p>
                <div class="flex flex-col md:flex-row items-center justify-around space-y-4 md:space-y-0 md:space-x-4">
                    <div class="text-center p-4 border-2 border-dashed border-gray-300 rounded-lg tooltip-container">
                        <h4 class="font-bold">1. Preview Sessions</h4>
                        <p class="text-xs text-gray-500">Core Team Only (1hr)</p>
                        <p class="text-sm mt-1">High-level overview & content filtering.</p>
                        <span class="tooltip tooltip-dark-green">Internal sessions to align the core project team and refine content before broader stakeholder engagement. <strong>Purpose:</strong> Prevent "opening a can of worms" by showing irrelevant or premature info.</span>
                    </div>
                    <div class="flow-arrow transform md:rotate-0">↓</div>
                    <div class="text-center p-4 border-2 border-dashed border-teal-400 rounded-lg tooltip-container">
                        <h4 class="font-bold">2. Workshows</h4>
                        <p class="text-xs text-gray-500">Stakeholders (2hr)</p>
                        <p class="text-sm mt-1">"See what you're getting" with OOTB demos.</p>
                        <span class="tooltip tooltip-purple">Demonstrating out-of-the-box functionality to a wider audience. <strong>Definition:</strong> Purely for showing what it looks like and how it functions.</span>
                    </div>
                    <div class="flow-arrow transform md:rotate-0">↓</div>
                    <div class="text-center p-4 border-2 border-dashed border-orange-400 rounded-lg tooltip-container">
                        <h4 class="font-bold">3. Workshops</h4>
                        <p class="text-xs text-gray-500">Stakeholders</p>
                        <p class="text-sm mt-1">Capture gaps & configuration requirements.</p>
                        <span class="tooltip tooltip-dark-brown">Detailed requirements gathering sessions to capture specific needs and identify configuration requirements. <strong>Definition:</strong> The "interview" phase to capture specific needs, document gaps, and gather input for configuration.</span>
                    </div>
                </div>

                <!-- Container for the SPM Modules Chart -->
                <div class="mt-8 bg-white rounded-lg shadow-md p-6">
                    <div class="flex justify-between items-center cursor-pointer sub-collapsible-toggle" data-target="spm-modules-chart-content" tabindex="0" role="button" aria-expanded="true" aria-controls="spm-modules-chart-content">
                        <h4 class="font-bold text-lg text-gray-800 mb-0">SPM Modules Overview (Click for Details!)</h4>
                        <span class="collapsible-icon">▲</span>
                    </div>
                    <div id="spm-modules-chart-content" class="collapsible-content sub-collapsible-content"> <!-- Uncollapsed by default -->
                        <div class="chart-container h-48 md:h-64 mt-4">
                            <canvas id="spmModulesChart"></canvas>
                        </div>
                        <p class="text-center text-gray-500 text-sm mt-4">Click on a slice for more details.</p>
                    </div>
                </div>

                <!-- Collapsible content for Demand Management details -->
                <div class="mt-8 bg-white rounded-lg shadow-md p-6 spm-module-detail-panel hidden" id="demand-management-details-panel">
                    <div class="flex justify-between items-center cursor-pointer sub-collapsible-toggle hidden-sub-toggle" data-target="demand-management-details-content" tabindex="0" role="button" aria-expanded="false" aria-controls="demand-management-details-content">
                        <h4 class="font-bold text-lg text-gray-800 mb-0">Demand Management Details</h4>
                        <span class="collapsible-icon">▼</span>
                    </div>
                    <div id="demand-management-details-content" class="collapsible-content sub-collapsible-content collapsed demand-bg-light">
                        <p class="text-sm text-gray-700 mt-2"><strong>Purpose:</strong> Structured intake of business requests and ideas.</p>
                        <h5 class="font-bold text-md mt-4">Key Personas:</h5>
                        <ul class="custom-bullet-list pl-4">
                            <li>Demand Managers</li>
                            <li>Business Relationship Managers</li>
                            <li>Portfolio Managers</li>
                        </ul>
                        <h5 class="font-bold text-md mt-4">Key Topics:</h5>
                        <ul class="custom-bullet-list">
                            <li>Demand Catalog Item</li>
                            <li>Demand Record</li>
                            <li>Demand Tasks</li>
                            <li>Demand Workflow Process</li>
                            <li>Workbench</li>
                            <li>Integration w/ Project & Resource Management</li>
                        </ul>
                    </div>
                </div>

                <!-- Collapsible content for Project Management details -->
                <div class="mt-8 bg-white rounded-lg shadow-md p-6 spm-module-detail-panel hidden" id="project-management-details-panel">
                    <div class="flex justify-between items-center cursor-pointer sub-collapsible-toggle hidden-sub-toggle" data-target="project-management-details-content" tabindex="0" role="button" aria-expanded="false" aria-controls="project-management-details-content">
                        <h4 class="font-bold text-lg text-gray-800 mb-0">Project Management Details</h4>
                        <span class="collapsible-icon">▼</span>
                    </div>
                    <div id="project-management-details-content" class="collapsible-content sub-collapsible-content collapsed project-bg-light">
                        <p class="text-sm text-gray-700 mt-2"><strong>Purpose:</strong> Execute approved work using Waterfall or Agile methods.</p>
                        <h5 class="font-bold text-md mt-4">Key Personas:</h5>
                        <ul class="custom-bullet-list pl-4">
                            <li>Project Managers</li>
                            <li>Portfolio Managers</li>
                            <li>Team Members</li>
                        </ul>
                        <h5 class="font-bold text-md mt-4">Key Topics:</h5>
                        <ul class="custom-bullet-list">
                            <li>Project Initiation</li>
                            <li>Project Planning</li>
                            <li>Project Workspace</li>
                            <li>Status Reports</li>
                            <li>Export to PowerPoint – Customer Note: G-Suite mostly so Google Slides… can likely remove this topic.</li>
                            <li>Integration w/ Demand & Resource Management</li>
                        </ul>
                    </div>
                </div>

                <!-- NEW: Collapsible content for Resource Management details -->
                <div class="mt-8 bg-white rounded-lg shadow-md p-6 spm-module-detail-panel hidden" id="resource-management-details-panel">
                    <div class="flex justify-between items-center cursor-pointer sub-collapsible-toggle hidden-sub-toggle" data-target="resource-management-details-content" tabindex="0" role="button" aria-expanded="false" aria-controls="resource-management-details-content">
                        <h4 class="font-bold text-lg text-gray-800 mb-0">Resource Management Details</h4>
                        <span class="collapsible-icon">▼</span>
                    </div>
                    <div id="resource-management-details-content" class="collapsible-content sub-collapsible-content collapsed resource-bg-light">
                        <p class="text-sm text-gray-700 mt-2"><strong>Purpose:</strong> Allocate resources based on capacity and demand.</p>
                        <h5 class="font-bold text-md mt-4">Key Personas:</h5>
                        <ul class="custom-bullet-list pl-4">
                            <li>Resource Managers</li>
                            <li>PMs</li>
                            <li>Department Heads</li>
                        </ul>
                        <h5 class="font-bold text-md mt-4">Key Topics:</h5>
                        <ul class="custom-bullet-list">
                            <li>Resource assignment form</li>
                            <li>Resource Capacity</li>
                            <li>Project Workspace>Resource Assignments</li>
                            <li>Skills & Roles</li>
                            <li>My Calendar view</li>
                            <li>Integration w/ Demand & Project</li>
                            <li><span class="italic text-gray-600">Customer Note: Resource Manager is not necessarily a role to focus on since RM is usually done in JIRA. Discussion focuses on capabilities and Capex best practices/use cases.</span></li>
                        </ul>
                    </div>
                </div>

                <!-- NEW: Collapsible content for Time Management details -->
                <div class="mt-8 bg-white rounded-lg shadow-md p-6 spm-module-detail-panel hidden" id="time-management-details-panel">
                    <div class="flex justify-between items-center cursor-pointer sub-collapsible-toggle hidden-sub-toggle" data-target="time-management-details-content" tabindex="0" role="button" aria-expanded="false" aria-controls="time-management-details-content">
                        <h4 class="font-bold text-lg text-gray-800 mb-0">Time Management Details</h4>
                        <span class="collapsible-icon">▼</span>
                    </div>
                    <div id="time-management-details-content" class="collapsible-content sub-collapsible-content collapsed time-bg-light">
                        <p class="text-sm text-gray-700 mt-2"><strong>Purpose:</strong> Track time spent across work for insights and reporting.</p>
                        <h5 class="font-bold text-md mt-4">Key Personas:</h5>
                        <ul class="custom-bullet-list pl-4">
                            <li>Team Members</li>
                            <li>Resource Managers</li>
                            <li>Finance</li>
                        </ul>
                        <h5 class="font-bold text-md mt-4">Key Topics:</h5>
                        <ul class="custom-bullet-list">
                            <li>Timecard Form</li>
                            <li>Timecard Submission/Approval/Rejection</li>
                            <li>Time Sheet Portal</li>
                            <li>Rate Types</li>
                            <li>Project Time Categories</li>
                            <li>Time Sheet Tracking</li>
                        </ul>
                    </div>
                </div>

            </div>
        </section>

    </div>

    <script>
        /**
         * The main entry point for the JavaScript logic, ensuring the DOM is fully loaded.
         * All primary event listeners, initial setups, and complex logic are encapsulated here.
         */
        (function() { // Start of IIFE

            /**
             * Helper function to consistently manage the collapsed/expanded state of content sections.
             * This ensures proper class toggling, ARIA attribute updates, and icon changes.
             * @param {HTMLElement} contentElement - The content div that needs to be collapsed or expanded.
             * @param {HTMLElement} toggleElement - The toggle button/header associated with the content.
             * @param {boolean} isCollapsed - True to collapse the element, false to expand it.
             * @returns {void}
             */
            function setCollapsedState(contentElement, toggleElement, isCollapsed) {
                if (!contentElement || !toggleElement) {
                    console.warn('setCollapsedState: Missing contentElement or toggleElement.');
                    return;
                }
                
                contentElement.classList.toggle('collapsed', isCollapsed);
                toggleElement.classList.toggle('collapsed', isCollapsed);
                toggleElement.setAttribute('aria-expanded', String(!isCollapsed));
                const icon = toggleElement.querySelector('.collapsible-icon');
                if (icon) {
                    icon.textContent = isCollapsed ? '▼' : '▲';
                }
            }

            // Removed initializeStakeholderChart as per the requirements.

            /**
             * Manages the visibility of the main header based on the expanded/collapsed state
             * of various sections, particularly the "Workshows & Workshops Structure" and its
             * detailed module panels.
             *
             * The header is hidden ONLY IF:
             * 1. The "Workshows & Workshops Structure" section is open.
             * 2. AND at least one of its module detail *panels* (Demand, Project, Resource, Time Management) is visible.
             * 3. AND NO other primary top-level section (e.g., Organizational Landscape, Engagement Timeline) is open.
             * In all other cases, the header remains sticky/visible.
             * @param {HTMLElement} mainHeader - The main header element to control.
             * @param {HTMLElement} workshopsStructureContent - The content element of the 'Workshows & Workshops Structure' section.
             * @param {NodeListOf<Element>} spmModuleDetailPanels - A NodeList of all SPM module detail panel elements.
             * @param {Array<string>} otherMainSectionContentIds - An array of IDs for other primary section content elements.
             * @returns {void}
             */
            const manageHeaderVisibility = (mainHeader, workshopsStructureContent, spmModuleDetailPanels, otherMainSectionContentIds) => {
                try {
                    if (!mainHeader || !workshopsStructureContent || !spmModuleDetailPanels) {
                        console.warn("manageHeaderVisibility: Missing required DOM elements.");
                        return;
                    }

                    // Safely declare and assign isWorkshowsStructureOpen
                    let isWorkshowsStructureOpen = false;
                    if (workshopsStructureContent && workshopsStructureContent.classList) {
                        isWorkshowsStructureOpen = !workshopsStructureContent.classList.contains('collapsed');
                    } else {
                        console.warn("manageHeaderVisibility: workshopsStructureContent or its classList is unexpectedly missing. Defaulting isWorkshowsStructureOpen to false.");
                        // Continue execution with default false, or return if this state is unrecoverable
                    }
                    
                    // 2. Check if any specific module detail *panel* within 'Workshows & Workshops Structure' is currently visible.
                    const anyModuleDetailPanelVisible = Array.from(spmModuleDetailPanels).some(panel => !panel.classList.contains('hidden'));

                    // 3. Check if any *other* primary top-level section (excluding the 'Workshows & Workshops Structure' itself) is open.
                    const anyOtherMainSectionOpen = otherMainSectionContentIds.some(id => {
                        const content = document.getElementById(id);
                        // Ensure the content element exists and is not collapsed
                        // Exclude the workshops structure itself from 'other' sections check for this specific logic
                        return content && (content.id !== workshopsStructureContent.id) && !content.classList.contains('collapsed');
                    });

                    // Determine if the header should be hidden based on the defined conditions.
                    const shouldHeaderBeHidden = isWorkshowsStructureOpen && anyModuleDetailPanelVisible && !anyOtherMainSectionOpen;

                    if (shouldHeaderBeHidden) {
                        mainHeader.classList.add('hidden-header');
                    } else {
                        mainHeader.classList.remove('hidden-header');
                    }
                } catch (error) {
                    console.error("Error in manageHeaderVisibility:", error);
                }
            };

            /**
             * Initial setup for all collapsible sections on page load:
             * All sections start collapsed by default, except the SPM Modules Chart content.
             * Also ensures module detail panels are hidden initially.
             * @param {NodeListOf<Element>} allToggles - A NodeList of all collapsible toggle elements.
             * @param {HTMLElement} mainHeader - The main header element for visibility management.
             * @param {HTMLElement} workshopsStructureContent - The content element of the 'Workshows & Workshops Structure' section.
             * @param {NodeListOf<Element>} spmModuleDetailPanels - A NodeList of all SPM module detail panel elements.
             * @param {Array<string>} otherMainSectionContentIds - An array of IDs for other primary section content elements.
             * @returns {void}
             */
            function initializeCollapsibleSections(allToggles, mainHeader, workshopsStructureContent, spmModuleDetailPanels, otherMainSectionContentIds) {
                allToggles.forEach(toggle => {
                    try {
                        const targetContentId = toggle.dataset.target;
                        const targetContentElement = document.getElementById(targetContentId);
                        
                        if (!targetContentElement) {
                            console.error(`Initialization Error: Target content with ID "${targetContentId}" not found for toggle:`, toggle);
                            return;
                        }

                        // If it's the SPM Modules Chart content, ensure it's uncollapsed initially.
                        if (targetContentId === 'spm-modules-chart-content') {
                            setCollapsedState(targetContentElement, toggle, false); // Initialize as uncollapsed
                        } else {
                            setCollapsedState(targetContentElement, toggle, true); // Initialize all other sections as collapsed
                        }

                        // For specific module detail toggles, ensure they are hidden initially.
                        // Their parent panels are already hidden via HTML classes.
                        if (toggle.classList.contains('hidden-sub-toggle')) {
                            toggle.classList.add('hidden-sub-toggle'); // Ensure it stays hidden
                            // No need to hide the parent panel here, it's handled by HTML or chart click
                        }

                    } catch (error) {
                        console.error("Error during initial toggle setup:", error);
                    }
                });
                // Call header visibility manager once after initial setup.
                manageHeaderVisibility(mainHeader, workshopsStructureContent, spmModuleDetailPanels, otherMainSectionContentIds);
            }

            /**
             * Initializes the SPM Modules doughnut chart and defines its click behavior.
             * On slice click, it expands the parent 'Workshows & Workshops Structure' section
             * (if collapsed), then hides all other module detail panels and reveals the clicked one.
             * Finally, it updates the main header visibility.
             * @param {HTMLCanvasElement} spmModulesCtxElement - The canvas element for the SPM modules chart.
             * @param {HTMLElement} workshopsStructureToggle - The toggle element for the 'Workshows & Workshops Structure' section.
             * @param {HTMLElement} workshopsStructureContent - The content element for the 'Workshows & Workshops Structure' section.
             * @param {HTMLElement} mainHeader - The main header element for visibility management.
             * @param {NodeListOf<Element>} spmModuleDetailPanels - A NodeList of all SPM module detail panel elements.
             * @param {Array<string>} otherMainSectionContentIds - An array of IDs for other primary section content elements.
             * @returns {void}
             */
            function initializeSpmModulesChart(spmModulesCtxElement, workshopsStructureToggle, workshopsStructureContent, mainHeader, spmModuleDetailPanels, otherMainSectionContentIds) {
                if (!spmModulesCtxElement) {
                    console.warn("initializeSpmModulesChart: Canvas element not found, skipping initialization.");
                    return;
                }
                try {
                    const spmModulesChart = new Chart(spmModulesCtxElement.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: ['Demand Management', 'Project Management', 'Resource Management', 'Time Management'],
                            datasets: [{
                                label: 'Business PMO Contacts',
                                data: [40, 30, 20, 10], // Relative sizes: Demand > Project > Resource > Time
                                backgroundColor: [
                                    '#00A9E0', // Teal for Demand
                                    '#4CAF50', // Green for Project
                                    '#FFC107', // Yellow for Resource
                                    '#F37021'  // Orange for Time
                                ],
                                borderColor: '#FFFFFF',
                                borderWidth: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            cutout: '70%',
                            plugins: {
                                legend: {
                                    position: 'bottom', // Show legend at the bottom
                                    labels: {
                                        color: '#333' // Legend text color
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(tooltipItem) {
                                            return tooltipItem.label + ': ' + tooltipItem.raw + '%';
                                        }
                                    }
                                }
                            },
                            onClick: (event, elements) => {
                                try {
                                    if (elements.length > 0) {
                                        const clickedElementIndex = elements[0].index;
                                        const clickedLabel = spmModulesChart.data.labels[clickedElementIndex];

                                        // Ensure the parent 'Workshows & Workshops Structure' section is expanded
                                        if (workshopsStructureContent && workshopsStructureContent.classList.contains('collapsed')) {
                                            setCollapsedState(workshopsStructureContent, workshopsStructureToggle, false); // Explicitly expand parent
                                        }

                                        // Map of all module details including their panel elements
                                        const moduleDetailsMap = {
                                            'Demand Management': {
                                                panel: document.getElementById('demand-management-details-panel'),
                                                content: document.getElementById('demand-management-details-content'),
                                                toggle: document.querySelector('#demand-management-details-panel .sub-collapsible-toggle'),
                                                bgColorClass: 'demand-bg-light'
                                            },
                                            'Project Management': {
                                                panel: document.getElementById('project-management-details-panel'),
                                                content: document.getElementById('project-management-details-content'),
                                                toggle: document.querySelector('#project-management-details-panel .sub-collapsible-toggle'),
                                                bgColorClass: 'project-bg-light'
                                            },
                                            'Resource Management': {
                                                panel: document.getElementById('resource-management-details-panel'),
                                                content: document.getElementById('resource-management-details-content'),
                                                toggle: document.querySelector('#resource-management-details-panel .sub-collapsible-toggle'),
                                                bgColorClass: 'resource-bg-light'
                                            },
                                            'Time Management': {
                                                panel: document.getElementById('time-management-details-panel'),
                                                content: document.getElementById('time-management-details-content'),
                                                toggle: document.querySelector('#time-management-details-panel .sub-collapsible-toggle'),
                                                bgColorClass: 'time-bg-light'
                                            }
                                        };

                                        // Iterate through all module details to manage their visibility (hide others, show clicked)
                                        for (const labelKey in moduleDetailsMap) {
                                            const module = moduleDetailsMap[labelKey];
                                            if (!module.panel || !module.content || !module.toggle) {
                                                console.warn(`Chart click handler: Missing elements for module "${labelKey}".`);
                                                continue;
                                            }

                                            if (labelKey === clickedLabel) { // This is the module corresponding to the clicked slice
                                                // Toggle visibility: If already open, close it; otherwise, open it.
                                                const isCurrentlyOpen = !module.content.classList.contains('collapsed');

                                                if (isCurrentlyOpen) { // If it's open, now close it
                                                    module.panel.classList.add('hidden'); // Hide the entire panel
                                                    setCollapsedState(module.content, module.toggle, true); // Collapse content
                                                    module.toggle.classList.add('hidden-sub-toggle'); // Hide its own toggle
                                                    module.content.classList.remove(module.bgColorClass); // Remove background
                                                } else { // If it's closed, now open it
                                                    module.panel.classList.remove('hidden'); // Show the entire panel
                                                    module.toggle.classList.remove('hidden-sub-toggle'); // Show its own toggle
                                                    setCollapsedState(module.content, module.toggle, false); // Uncollapse content
                                                    module.content.classList.add(module.bgColorClass); // Apply background color
                                                    module.panel.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); // Scroll to the panel
                                                }
                                            } else { // This is a different module, so hide it completely
                                                setCollapsedState(module.content, module.toggle, true); // Collapse content
                                                module.toggle.classList.add('hidden-sub-toggle'); // Hide toggle
                                                module.content.classList.remove(module.bgColorClass); // Remove background
                                                module.panel.classList.add('hidden'); // Hide the entire panel container
                                            }
                                        }
                                        
                                        // IMPORTANT: Call manageHeaderVisibility after all panel and content states have been updated
                                        manageHeaderVisibility(mainHeader, workshopsStructureContent, spmModuleDetailPanels, otherMainSectionContentIds);
                                    }
                                } catch (error) {
                                    console.error("Error in Chart.js onClick handler:", error);
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error("Error initializing SPM Modules Chart:", error);
                }
            }


            /**
             * Sets up event listeners for all collapsible toggles across the infographic.
             * Handles expanding/collapsing content, managing related panel visibility,
             * updating logo state, and triggering overall header visibility updates.
             * @param {NodeListOf<Element>} allToggles - A NodeList of all collapsible toggle elements.
             * @param {HTMLElement} echostarLogo - The EchoStar logo element for shrinking/expanding.
             * @param {Array<HTMLElement>} mainCollapsibleTogglesForLogo - An array of primary section toggles affecting logo state.
             * @param {HTMLElement} mainHeader - The main header element for visibility management.
             * @param {HTMLElement} workshopsStructureContent - The content element of the 'Workshows & Workshops Structure' section.
             * @param {NodeListOf<Element>} spmModuleDetailPanels - A NodeList of all SPM module detail panel elements.
             * @param {Array<string>} otherMainSectionContentIds - An array of IDs for other primary section content elements.
             * @returns {void}
             */
            function setupCollapsibleToggleListeners(allToggles, echostarLogo, mainCollapsibleTogglesForLogo, mainHeader, workshopsStructureContent, spmModuleDetailPanels, otherMainSectionContentIds) {
                allToggles.forEach(toggleElement => {
                    try {
                        const targetContentId = toggleElement.dataset.target;
                        const targetContentElement = document.getElementById(targetContentId);
                        
                        if (!targetContentElement) {
                            console.error(`Event Listener Setup Error: Target content with ID "${targetContentId}" not found for toggle:`, toggleElement);
                            return;
                        }

                        const handleToggleClick = () => {
                            const isCurrentlyCollapsed = targetContentElement.classList.contains('collapsed');
                            
                            // Toggle the state of the content and its associated toggle visual.
                            setCollapsedState(targetContentElement, toggleElement, !isCurrentlyCollapsed);

                            // Specific logic for SPM module detail panels: if main "Workshows & Workshops Structure"
                            // section is being collapsed, hide its sub-panels.
                            if (targetContentId === 'workshops-structure-content' && targetContentElement.classList.contains('collapsed')) {
                                Array.from(spmModuleDetailPanels).forEach(panel => {
                                    panel.classList.add('hidden'); // Hide the panel
                                    const content = document.getElementById(panel.querySelector('[data-target]').dataset.target);
                                    const toggle = panel.querySelector('.sub-collapsible-toggle');
                                    if (content && toggle) {
                                        setCollapsedState(content, toggle, true); // Ensure content is collapsed
                                        toggle.classList.add('hidden-sub-toggle'); // Hide toggle
                                        content.classList.remove('demand-bg-light', 'project-bg-light', 'resource-bg-light', 'time-bg-light'); // Remove background
                                    }
                                });
                            }

                            // Logic for shrinking/expanding the EchoStar logo in the header
                            if (mainCollapsibleTogglesForLogo.includes(toggleElement)) {
                                if (!targetContentElement.classList.contains('collapsed')) { // This main section is now expanded
                                    echostarLogo.classList.add('logo-shrink');
                                } else { // This main section is now collapsed
                                    // Check if ANY other main section is still expanded to keep logo shrunk
                                    const anyOtherMainSectionExpandedForLogo = mainCollapsibleTogglesForLogo.some(otherToggle => {
                                        const otherContent = document.getElementById(otherToggle.dataset.target);
                                        // Make sure 'otherContent' exists, is not the current 'targetContentElement', and is not collapsed
                                        return otherContent && (otherContent.id !== targetContentElement.id) && !otherContent.classList.contains('collapsed');
                                    });

                                    if (!anyOtherMainSectionExpandedForLogo) {
                                        echostarLogo.classList.remove('logo-shrink');
                                    }
                                }
                            }
                            
                            // Always call the centralized header visibility manager after any toggle action.
                            manageHeaderVisibility(mainHeader, workshopsStructureContent, spmModuleDetailPanels, otherMainSectionContentIds);
                        };

                        toggleElement.addEventListener('click', handleToggleClick);
                        toggleElement.addEventListener('keydown', (e) => {
                            if (e.key === 'Enter' || e.key === ' ') {
                                e.preventDefault(); // Prevent default scroll behavior for spacebar and enter
                                handleToggleClick();
                            }
                        });
                    } catch (error) {
                        console.error("Error setting up toggle event listener:", error);
                    }
                });
            }

            /**
             * Manages the text carousel effect in the header.
             * Alternates between the main title and a strategic descriptive paragraph.
             * @param {HTMLElement} mainTitle - The main title element.
             * @param {HTMLElement} strategyText - The strategic text element.
             * @returns {void}
             */
            function setupHeaderTextCarousel(mainTitle, strategyText) {
                let isTitleActive = true;

                // Set initial state for carousel
                if (!mainTitle || !strategyText) {
                    console.warn("setupHeaderTextCarousel: Header text elements not found, carousel disabled.");
                    return; // Exit if elements are missing
                }

                mainTitle.classList.add('active-fade', 'h1-glow');
                strategyText.classList.add('inactive-fade');

                function toggleHeaderText() {
                    if (isTitleActive) {
                        // Deactivate title, activate paragraph
                        mainTitle.classList.remove('active-fade', 'h1-glow');
                        mainTitle.classList.add('inactive-fade');
                        strategyText.classList.remove('inactive-fade');
                        strategyText.classList.add('active-fade');
                    } else {
                        // Activate title, deactivate paragraph
                        mainTitle.classList.remove('inactive-fade');
                        mainTitle.classList.add('active-fade', 'h1-glow');
                        strategyText.classList.remove('active-fade');
                        strategyText.classList.add('inactive-fade');
                    }
                    isTitleActive = !isTitleActive;
                }
                
                try {
                    setInterval(toggleHeaderText, 8000); // Adjusted from 5000ms to 8000ms
                } catch (error) {
                    console.error("Error starting header text carousel interval:", error);
                }
            }


            /**
             * Controls the visibility of future roadmap phases and their details.
             * Toggles elements with 'hidden-element' and 'show-element' classes.
             * @param {HTMLElement} showFutureButton - The button to toggle future states.
             * @param {NodeListOf<Element>} futureTimelineElements - Elements forming the future timeline visualization.
             * @param {NodeListOf<Element>} futureDetailCards - Detail cards for future phases.
             * @returns {void}
             */
            function setupFutureStatesToggle(showFutureButton, futureTimelineElements, futureDetailCards) {
                let futureStatesVisible = false;

                // Initially hide the future detail cards and timeline elements
                futureTimelineElements.forEach(el => {
                    if (el) { // Ensure element exists before manipulating
                        el.classList.add('hidden-element');
                        el.style.display = 'none'; // Ensure they are initially display: none for layout
                    }
                });
                futureDetailCards.forEach(card => {
                    if (card) { // Ensure element exists before manipulating
                        card.classList.add('hidden-element'); // Hide with opacity and height collapse
                    }
                });

                if (showFutureButton) {
                    try {
                        showFutureButton.addEventListener('click', () => {
                            futureStatesVisible = !futureStatesVisible;

                            // Toggle visibility for roadmap timeline elements
                            futureTimelineElements.forEach(el => {
                                if (!el) return; // Skip if element is null

                                if (futureStatesVisible) {
                                    el.classList.remove('hidden-element');
                                    // Use flex/block display to participate in layout before opacity transition
                                    el.style.display = el.classList.contains('roadmap-milestone') ? 'flex' : 'block';
                                    setTimeout(() => el.classList.add('show-element'), 10); // Trigger opacity transition after display
                                } else {
                                    el.classList.remove('show-element');
                                    // Hide element completely after opacity transition is done
                                    el.addEventListener('transitionend', function handler() {
                                        el.style.display = 'none';
                                        el.removeEventListener('transitionend', handler);
                                    }, { once: true });
                                    // Fallback for cases where transition might not fire (e.g., if already hidden)
                                    if (getComputedStyle(el).transitionDuration === '0s' || parseFloat(getComputedStyle(el).opacity) === 0) {
                                        el.style.display = 'none';
                                    }
                                    el.classList.add('hidden-element');
                                }
                            });

                            // Toggle visibility for detailed phase description cards
                            futureDetailCards.forEach(card => {
                                if (!card) return; // Skip if element is null

                                if (futureStatesVisible) {
                                    card.classList.remove('hidden-element');
                                    card.style.display = 'flex'; // Ensure flex display for grid items
                                    setTimeout(() => card.classList.add('show-element'), 10);
                                } else {
                                    card.classList.remove('show-element');
                                    card.addEventListener('transitionend', function handler() {
                                        card.style.display = 'none';
                                        card.removeEventListener('transitionend', handler);
                                    }, { once: true });
                                    if (getComputedStyle(card).transitionDuration === '0s' || parseFloat(getComputedStyle(card).opacity) === 0) {
                                        card.style.display = 'none';
                                    }
                                    card.classList.add('hidden-element');
                                }
                            });

                            // Update button text and ARIA expanded state
                            showFutureButton.textContent = futureStatesVisible ? 'Hide Future States' : 'Show Future States';
                            showFutureButton.setAttribute('aria-expanded', String(futureStatesVisible));
                        });
                    } catch (error) {
                        console.error("Error setting up future states button listener:", error);
                    }
                }
            }

            /**
             * Function to get and display the last update timestamp.
             * Formats the current date and time in Mountain Time (MT).
             * @returns {void}
             */
            function setLastUpdateTimestamp() {
                try {
                    const lastUpdatedElement = document.getElementById('lastUpdated');
                    if (lastUpdatedElement) {
                        const now = new Date();
                        // Using toLocaleString with specific options to format for Mountain Time (approximated)
                        const options = { 
                            year: 'numeric', 
                            month: 'long', 
                            day: 'numeric', 
                            hour: '2-digit', 
                            minute: '2-digit', 
                            hour12: true, 
                            timeZone: 'America/Denver' // Mountain Time Zone
                        };
                        const formattedDate = now.toLocaleString('en-US', options);
                        // Manually append "MT" as toLocaleString might use a full time zone name
                        lastUpdatedElement.textContent = `This site was updated on ${formattedDate.replace(' AM', ' AM MT').replace(' PM', ' PM MT')}`;
                    } else {
                        console.warn("setLastUpdateTimestamp: 'lastUpdated' element not found.");
                    }
                } catch (error) {
                    console.error("Error setting last update timestamp:", error);
                }
            }

            // Main execution block: Ensure DOM is loaded before running scripts
            document.addEventListener('DOMContentLoaded', function() {
                // Cache frequently used DOM elements once
                const mainHeader = document.getElementById('mainHeader');
                const echostarLogo = document.getElementById('echostarLogo');
                const mainTitle = document.getElementById('mainTitle');
                const strategyText = document.getElementById('strategyText');
                const workshopsStructureToggle = document.querySelector('#workshops-structure-section .collapsible-toggle');
                const workshopsStructureContent = document.getElementById('workshops-structure-content');
                const spmModulesCtxElement = document.getElementById('spmModulesChart');
                const spmModuleDetailPanels = document.querySelectorAll('.spm-module-detail-panel'); // All individual module panels

                // List of all main collapsible section content IDs (for header visibility logic)
                const otherMainSectionContentIds = [
                    'organization-content',
                    'metrics-stakeholders-content', // This is now 'Stakeholder Overview'
                    'timeline-content',
                    'workshops-structure-content'
                ];

                // List of all general toggles for event listener setup
                const allToggles = document.querySelectorAll('.collapsible-toggle, .sub-collapsible-toggle'); // Removed .stakeholder-card-toggle as they are now flip-cards
                // Main collapsible toggles that affect the logo size
                const mainCollapsibleTogglesForLogo = Array.from(document.querySelectorAll(
                    '#organization-section .collapsible-toggle, ' +
                    '#metrics-stakeholders-section .collapsible-toggle, ' + // Updated for Stakeholder Overview
                    '#timeline-section .collapsible-toggle, ' +
                    '#workshops-structure-section .collapsible-toggle'
                ));

                // Initialize all core functionalities
                initializeCollapsibleSections(allToggles, mainHeader, workshopsStructureContent, spmModuleDetailPanels, otherMainSectionContentIds);
                initializeSpmModulesChart(spmModulesCtxElement, workshopsStructureToggle, workshopsStructureContent, mainHeader, spmModuleDetailPanels, otherMainSectionContentIds);
                setupCollapsibleToggleListeners(allToggles, echostarLogo, mainCollapsibleTogglesForLogo, mainHeader, workshopsStructureContent, spmModuleDetailPanels, otherMainSectionContentIds);
                setupHeaderTextCarousel(mainTitle, strategyText);
                setLastUpdateTimestamp();
            });

        })(); // End of IIFE
    </script>
</body>
</html>
